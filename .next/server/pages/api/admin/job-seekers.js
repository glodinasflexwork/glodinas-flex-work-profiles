"use strict";(()=>{var e={};e.id=986,e.ids=[986],e.modules={1649:e=>{e.exports=require("next-auth/react")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,s)=>{Object.defineProperty(s,"l",{enumerable:!0,get:function(){return function e(s,r){return r in s?s[r]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,r)):"function"==typeof s&&"default"===r?s:void 0}}})},2141:(e,s,r)=>{r.r(s),r.d(s,{config:()=>g,default:()=>f,routeModule:()=>p});var t={};r.r(t),r.d(t,{default:()=>d});var n=r(1802),a=r(7153),i=r(6249),o=r(1649),u=r(3214);async function d(e,s){let r=await (0,o.getSession)({req:e});if(!r||!r.user)return s.status(401).json({message:"Unauthorized"});if(!await u.Z.admin.findUnique({where:{email:r.user.email}}))return s.status(403).json({message:"Forbidden: Admin access required"});switch(e.method){case"GET":return c(e,s);case"PUT":return l(e,s);case"DELETE":return m(e,s);default:return s.status(405).json({message:"Method not allowed"})}}async function c(e,s){try{let{page:r=1,limit:t=10,status:n,search:a}=e.query,i=(parseInt(r)-1)*parseInt(t),o={};n&&(o.status=n),a&&(o.OR=[{firstName:{contains:a,mode:"insensitive"}},{lastName:{contains:a,mode:"insensitive"}},{email:{contains:a,mode:"insensitive"}},{skills:{contains:a,mode:"insensitive"}},{preferredLocation:{contains:a,mode:"insensitive"}}]),console.log("Job seekers query:",{where:o,skip:i,take:parseInt(t)});let d=await u.Z.jobSeeker.findMany({where:o,skip:i,take:parseInt(t),orderBy:{createdAt:"desc"}}),c=await u.Z.jobSeeker.count({where:o});return console.log(`Found ${c} job seekers matching criteria`),s.status(200).json({data:d,pagination:{total:c,page:parseInt(r),limit:parseInt(t),totalPages:Math.ceil(c/parseInt(t))}})}catch(e){return console.error("Error fetching job seekers:",e),s.status(500).json({message:"Error fetching job seekers",error:e.message})}}async function l(e,s){try{let{id:r}=e.query,{status:t}=e.body;if(!r)return s.status(400).json({message:"Job seeker ID is required"});if(!t||!["pending","reviewed","matched"].includes(t))return s.status(400).json({message:"Valid status is required"});let n=await u.Z.jobSeeker.update({where:{id:r},data:{status:t}});return s.status(200).json({success:!0,message:"Job seeker status updated successfully",data:n})}catch(e){return console.error("Error updating job seeker:",e),s.status(500).json({message:"Error updating job seeker",error:e.message})}}async function m(e,s){try{let{id:r}=e.query;if(!r)return s.status(400).json({message:"Job seeker ID is required"});return await u.Z.jobSeeker.delete({where:{id:r}}),s.status(200).json({success:!0,message:"Job seeker deleted successfully"})}catch(e){return console.error("Error deleting job seeker:",e),s.status(500).json({message:"Error deleting job seeker",error:e.message})}}let f=(0,i.l)(t,"default"),g=(0,i.l)(t,"config"),p=new n.PagesAPIRouteModule({definition:{kind:a.x.PAGES_API,page:"/api/admin/job-seekers",pathname:"/api/admin/job-seekers",bundlePath:"",filename:""},userland:t})},3214:(e,s,r)=>{r.d(s,{Z:()=>n});let t=require("@prisma/client"),n=global.prisma||new t.PrismaClient},7153:(e,s)=>{var r;Object.defineProperty(s,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,s,r)=>{e.exports=r(145)}};var s=require("../../../webpack-api-runtime.js");s.C(e);var r=s(s.s=2141);module.exports=r})();