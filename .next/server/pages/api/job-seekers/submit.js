"use strict";(()=>{var e={};e.id=29,e.ids=[29],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6555:e=>{e.exports=import("uuid")},2781:e=>{e.exports=require("stream")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},2819:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>u,default:()=>c,routeModule:()=>d});var a=r(1802),i=r(7153),n=r(6249),o=r(9654),l=e([o]);o=(l.then?(await l)():l)[0];let c=(0,n.l)(o,"default"),u=(0,n.l)(o,"config"),d=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/job-seekers/submit",pathname:"/api/job-seekers/submit",bundlePath:"",filename:""},userland:o});s()}catch(e){s(e)}})},4347:(e,t,r)=>{require("cloudinary").v2.config({cloud_name:"dkk1xih2f",api_key:"343831827957133",api_secret:"Z5yn2Kfed_sLP9ofj2nXSIGns5o"})},3214:(e,t,r)=>{r.d(t,{Z:()=>a});let s=require("@prisma/client"),a=global.prisma||new s.PrismaClient},9654:(e,t,r)=>{r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{config:()=>c,default:()=>l});var a=r(6555),i=r(3214);r(4347);var n=e([a]);a=(n.then?(await n)():n)[0];let c={api:{bodyParser:{sizeLimit:"10mb"}}};function o(e,t,r=null){let s=new Date().toISOString();console.log(`[JOB-SEEKER-SUBMIT][${s}][${e}] ${t}`),r&&console.log(JSON.stringify(r,null,2))}async function l(e,t){if(o("INFO","Job seeker submission request received",{method:e.method,url:e.url}),"POST"!==e.method)return o("ERROR","Method not allowed",{method:e.method}),t.status(405).json({message:"Method not allowed"});try{let r=e.body;o("INFO","Processing form data");let{firstName:s,lastName:a,email:n,phone:l,experience:c,skills:u,availability:d,preferredLocation:m}=r,p={...r};p.email&&(p.email="***@***"),p.phone&&(p.phone="***"),o("DEBUG","Received form fields",p);let f=Object.entries({firstName:!!s,lastName:!!a,email:!!n,phone:!!l,experience:!!c,skills:!!u,availability:!!d,preferredLocation:!!m}).filter(([e,t])=>!t).map(([e])=>e);if(f.length>0)return o("ERROR","Missing required fields",{missingFields:f}),t.status(400).json({success:!1,message:"Missing required fields",fields:f});if(o("INFO","All required fields present"),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return o("ERROR","Invalid email format",{email:"***@***"}),t.status(400).json({success:!1,message:"Invalid email format"});o("INFO","Email format validated"),o("INFO","File upload skipped in this version");try{o("INFO","Attempting to create job seeker record in database");try{await i.Z.$queryRaw`SELECT 1`,o("INFO","Database connection successful")}catch(e){o("ERROR","Database connection failed",{error:e.toString(),stack:e.stack})}let e={firstName:s.toString(),lastName:a.toString(),email:n.toString(),phone:l.toString(),experience:c.toString(),skills:u.toString(),availability:d.toString(),preferredLocation:m.toString(),cvUrl:null,status:"pending"};o("DEBUG","Job seeker data prepared",{...e,email:"***@***",phone:"***"});let r=await i.Z.jobSeeker.create({data:e});return o("SUCCESS","Job seeker created successfully",{id:r.id,status:r.status,createdAt:r.createdAt}),t.status(201).json({success:!0,message:"Job seeker application received successfully",data:{id:r.id,status:r.status}})}catch(e){return o("ERROR","Database error creating job seeker",{error:e.toString(),code:e.code,meta:e.meta,stack:e.stack}),t.status(500).json({success:!1,message:"Database error while processing your application",error:e.message})}}catch(e){return o("ERROR","Error submitting job seeker form",{error:e.toString(),stack:e.stack}),t.status(500).json({success:!1,message:"An error occurred while processing your application",error:e.message})}}s()}catch(e){s(e)}})},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var r=t(t.s=2819);module.exports=r})();